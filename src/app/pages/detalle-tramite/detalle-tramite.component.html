
<app-hero-banner-lite word=""></app-hero-banner-lite>
<div *ngIf="loadingData === false; else elseBlock">
    <div class="container">
        <div class="d-flex flex-column align-items-center justify-content-center" style="height: 400px;">
            <p class="fw-lighter text-center">Obteniendo la información solicitada, por favor espere un momento.</p>
            <div class="align-self-center align-self-lg-center">
                <div class="lds-ring"><div></div><div></div><div></div><div></div></div>
            </div>
            <!-- <div class="mb-auto p-2"></div> -->
          </div>
    </div>  
</div>

<ng-template #elseBlock class="px-3 py-1">
    <div class="container">
        <!-- INFO PRINCIPAL -->
        <div class="card">
            <div class="card-header fw-bolder bg-color text-white">
              {{tramite.nombre}}
            </div>
            <div class="card-body">
                <div class="container">
                    <div class="row justify-content-lg-start m-2">
                        <div class="col col-auto">
                            <strong>Homoclave:</strong>
                        </div>
                        <div class="col col-auto">
                            {{ tramite.homoclave }}
                        </div>
                        <div class="col col-auto">
                            <strong>Tipo de {{ tramite.tramiteServicio === 'Trámite' ? 'Trámite' : 'Servicio' }}:</strong>
                        </div>
                        <div class="col col-auto">
                            {{ tramite.tipo }}
                        </div>
                    </div>
                    <div *ngIf="tramite.modalidad != ''" class="row justify-content-lg-start m-2">
                        <div class="col col-auto">
                            <strong>Modalidad:</strong>
                        </div>
                        <div class="col col-auto">
                            {{ tramite.modalidad }}
                        </div>
                    </div>
                    <div class="row justify-content-lg-start m-2 ">
                        <div class="col col-auto">
                            <strong>Dependencia:</strong>
                        </div>
                        <div class="col col-auto">
                            {{ tramite.dependencia }}
                        </div>
                    </div>
                    <div class="row justify-content-lg-start m-2 ">
                        <div class="col col-auto">
                            <strong>Unidad Administrativa:</strong>
                        </div>
                        <div class="col col-auto">
                            {{ tramite.unidadAdministrativa }}
                        </div>
                    </div>
                    <hr>
                    <div class="row justify-content-lg-start m-2 ">
                        <div class="col col-auto">
                            <strong>Descripción:</strong>
                        </div>
                        <div class="col col-auto">
                            {{ tramite.descripcionCiudadana  }}
                        </div>
                    </div>
                    <hr>
                    <div class="row justify-content-lg-start m-2 ">
                        <div class="col col-auto">
                            <strong>ÚLTIMA ACTUALIZACIÓN:</strong>
                        </div>
                        <div class="col col-auto">
                            {{ fechaFormateada  }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="panel panel-group" id="accordion">
            <!-- QUE DEBO DE SABER ACERCA DEL TRÁMITE? -->
            <div class="panel panel-default">
              <div class="row cms-plugin cms-plugin-3">
                <div class="col-12 mb-3">
                  <div class="card">
                    <div class="heading-acc d-flex justify-content-between align-items-center p-4 p-md-5" (click)="toggleExpanded(1)">
                      <h3 class="card-title mbr-section-subtitle mbr-fonts-style display-7">
                        <strong>{{ getPanelTitle('¿QUÉ DEBO SABER ACERCA DEL') }}</strong>
                      </h3>
                      <div class="acc-button-container" [ngClass]="{ 'show': expanded[1] }">
                        <div class="acc-button">
                          <span class="acc-button-line1" [ngClass]="{ 'rotate-line1': expanded[1] }"></span>
                          <span class="acc-button-line2" [ngClass]="{ 'rotate-line2': expanded[1] }"></span>
                        </div>
                      </div>
                    </div>
                    
                    <div class="accordion-body px-4 px-md-5 collapse " [ngClass]="{ 'show': expanded[1] }">
                        <div class="container">
                            <ol class="mt-3">
    
                                <!-- ¿En que caso se debe realizar el tramite o servicio? -->
                                <li class="mt-2"><strong>¿En qué caso se debe realizar el trámite o servicio?</strong></li>
                                <ul>
                                    <li>{{ tramite.solicita[0].casoRealizaTramite }}</li>
                                </ul>
    
                                 <!-- ¿Quién puede realizarlo? -->
                                <li class="mt-2"><strong>¿Quién puede realizarlo?</strong></li>
                                <ul>
                                    <li *ngFor="let quienSolicita of tramite.solicita">
                                        {{ quienSolicita.quienSolicita === 'Otro' ? 'Otro: ' + tramite.traquienSolicita_Otro : quienSolicita.quienSolicita }}
                                    </li>
                                </ul>
                                
                                <li class="mt-2"><strong>Vigencia</strong></li>
                                <ul>
                                    <li>
                                        {{tramite.vigencia[0].vigenciaTramite}}
                                    </li>
                                </ul>
    
                                <!-- ¿Cuanto cuesta? -->
                                <li class="mt-2"> <strong>¿Cuánto cuesta? ({{tramite.costos.length > 0 ? tramite.costos[0].tipoCosto: "Gratuito"}})</strong></li>
                                <ul>
                                    <li *ngFor="let costo of tramite.costos">
                                        {{ costo.tipoCosto === 'Monto fijo' ? 'Monto: ' + formatearMonto(costo.monto, costo.moneda) : '' }}
                                    
                                     <!-- Rango -->
                                    <ng-container *ngIf="costo.tipoCosto === 'Monto calculado'">
                                        <li>{{ costo.monto ? 'Rango: ' + formatearMonto(costo.monto, costo.moneda) : '' }}</li>
                                        <li>{{ costo.formula ? 'Método de cálculo: ' + costo.formula : '' }}</li>
                                    </ng-container>
                                </li>
                                </ul>
    
                                <!-- ¿Cómo puedo realizar el pago? -->
                                <li class="mt-2"> <strong>Información acerca del pago:</strong></li>
                                <ul>
                                    <li>
                                        <dl>
                                            <dt>¿Dónde?</dt>
                                            <dd *ngFor="let costos of tramite.costos">
                                                {{costos.dondeRealizarPago === "" ? "No aplica" : costos.dondeRealizarPago}}
                                            </dd>
                                            <dd *ngIf="tramite.costos.length === 0">
                                                {{ "No aplica"}}
                                            </dd>
                                        </dl>
                                    </li>
                                    <li>
                                        <dl>
                                            <dt>¿En qué momento?</dt>
                                            <dd *ngFor="let costos of tramite.costos">
                                                {{costos.momentoRealizarPago === "" ? "No aplica" : costos.momentoRealizarPago}}
                                            </dd>
                                            <dd *ngIf="tramite.costos.length === 0">
                                                {{ "No aplica"}}
                                            </dd>
                                        </dl>
                                    </li>
                                    <li>
                                        <dl>
                                            <dt>Vigencia de la línea de captura (orden de pago)</dt>
                                            <dd>
                                                No aplica
                                            </dd>
                                        </dl>
                                    </li>
                                </ul>
                                <li class="mt-2"> <strong>Plazos</strong></li>
                                <ul>
                                    <li>
                                        <dl>
                                            <dt>Plazo de respuesta</dt>
                                            <ng-container *ngFor="let plazo of tramite.plazos">
                                                <dd *ngIf="plazo.nombrePlazo === 'Plazo de respuesta'">
                                                    Tiempo que tiene la dependencia para resolver: 
                                                    <b>
                                                        <!-- {{ limpiarPlazo(plazo.respuestaResolver) }} -->
                                                        <b>{{ plazo.respuestaResolver ? limpiarPlazo(plazo.respuestaResolver) : '' }}</b>
                                                    </b>
                                                </dd>
                                            </ng-container>
                                        </dl>
                                    </li>
                                    <li>
                                        <dl>
                                            <dt>Plazo de prevención</dt>
                                            <ng-container *ngFor="let plazo of tramite.plazos">
                                                <dd *ngIf="plazo.nombrePlazo === 'Plazo de prevención Dependencia'">
                                                    Plazo que tiene la dependencia para prevenir al solicitante: <b>{{plazo.paraPrevenir}}</b>
                                                </dd>
                                                <dd *ngIf="plazo.nombrePlazo === 'Plazo de prevención Usuario'">
                                                    Plazo que tiene el usuario para responder la prevención: <b>{{plazo.responderlaPrevencion}}</b>
                                                </dd>
                                                <!-- <dd *ngIf="plazo.nombrePlazo === 'Plazo de prevención Dependencia'">
                                                    Respuesta de la dependencia en caso de no responder en el tiempo establecido: <b>{{plazo.respuestaDependencia}}</b>
                                                </dd> -->
                                            </ng-container>
                                        </dl>
                                    </li>
                                </ul>
                                <li class="mt-2"> <strong>Afirmativa o Negativa Ficta</strong></li>
                                <ul>
                                    
                                    <ng-container *ngFor="let plazo of tramite.plazos">
                                        <li *ngIf="plazo.nombrePlazo === 'Plazo de prevención Dependencia' && plazo.respuestaDependencia">
                                            Respuesta de la dependencia en caso de no responder en el tiempo establecido: 
                                            <b>{{plazo.respuestaDependencia}}</b>
                                        </li>
                                    </ng-container>
                                    
                                </ul>       
                            </ol>

                            <hr style="border-style: dotted;">  


                            <!-- Información adicional -->
                            <h5 class="mt-2"><strong>Información adicional</strong></h5>
                            <strong>Información que sea útil para que el interesado realice el trámite:</strong>
                            <div>
                                {{ tramite.traComentariosRespecto }}
                            </div>

                        </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- QUÉ NECESITO PARA REALIZAR EL TRÁMITE? -->
            <div class="panel panel-default">
              <div class="row cms-plugin cms-plugin-3">
                <div class="col-12 mb-3">
                  <div class="card">
                    <div class="heading-acc d-flex justify-content-between align-items-center p-4 p-md-5" (click)="toggleExpanded(2)">
                      <h3 class="card-title mbr-section-subtitle mbr-fonts-style display-7">
                        <strong>{{ getPanelTitle('¿QUÉ NECESITO PARA REALIZAR EL') }}</strong>
                      </h3>
                      <div class="acc-button-container" [ngClass]="{ 'show': expanded[2] }">
                        <div class="acc-button">
                          <span class="acc-button-line1" [ngClass]="{ 'rotate-line1': expanded[2] }"></span>
                          <span class="acc-button-line2" [ngClass]="{ 'rotate-line2': expanded[2] }"></span>
                        </div>
                      </div>
                    </div>
                    
                    <div class="accordion-body px-4 px-md-5 collapse" [ngClass]="{ 'show': expanded[2] }">
                        <div class="container">
                            <div class="row justify-content-lg-start m-2">
                                <div class="col col-auto">
                                    <strong>Documentos o requisitos para realizar el trámite</strong>
                                </div>
                            </div>
    
                            <ol class="m-2">
                                <li *ngFor="let requisito of tramite.requisitos">
                                    <dl>
                                        <dt>{{requisito.nombre}}</dt>
                                        <dt>Presentación:</dt>
                                                    <dd>
                                                        <ul>
                                                            <li *ngIf="requisito.original === 'Sí'">
                                                                Original
                                                            </li>
                                                            <li *ngIf="requisito.copias != ''">
                                                                {{requisito.copias === "" ? "1": requisito.copias}} copia(s) 
                                                                {{requisito.copiasCerificadas === "" ? "": "Certificadas"}}
                                                            </li>
                                                        </ul>
                                                    </dd>
    
                                        <p>
                                            <button
                                                type="button"
                                                class="btn btn-link"
                                                (click)="toggleCollapse(requisito.requisitoId)"
                                                [attr.aria-expanded]="!isCollapsed[requisito.requisitoId]"
                                                aria-controls="collapseExample"
                                            >
                                            <fa-icon class="" [icon]="['fas', 'circle-plus']"></fa-icon> Detalles
                                            </button>
                                           
                                        </p>
                                        <div [ngbCollapse]="isCollapsed[requisito.requisitoId]" id="collapseExample{{ requisito.requisitoId }}">
                                            <div class="card">
                                                <div class="card-body">
                                                    <dt>Descripción:</dt>
                                                    <dd>{{requisito.descripcion}}</dd>
                                                    
                                                    <dt>Forma parte del formato:</dt>
                                                    <dd>{{ requisito.requisitoParteFormato }}</dd>
    
                                                    <ng-container *ngIf="requisito.naturalezaDelRequisito">
                                                        <dt>Naturaleza:</dt>
                                                        <dd>{{ requisito.naturalezaDelRequisito }}</dd>
                                                      </ng-container>                                                  
    
                                                    <dt>Tiempo promedio en conseguir el requisito para su presentación:</dt>
                                                    <dd>
                                                    {{ formatTiempoPromedio(
                                                            requisito.tiempoDias || 0,
                                                            requisito.tiempoHoras || 0,
                                                            requisito.tiempoMinutos || 0
                                                        )
                                                    }}
                                                    </dd>
                                                    <!-- Información adicional -->
                                                    <dt>Es necesario alguna firma, validación, certificación, autorización o visto bueno de un tercero:</dt>
                                                    <dd>
                                                        <span [ngClass]="{'selectsi': requisito.esNecesarioFirma, 'selectno': !requisito.esNecesarioFirma}">
                                                            {{ requisito.esNecesarioFirma ? 'Sí' : 'No' }}
                                                        </span>
                                                    </dd>
                                                    <dt *ngIf="requisito.tipoRevisionTercero_CatIdNom">Tipo de revisión necesaria:</dt>
                                                    <dd *ngIf="requisito.tipoRevisionTercero_CatIdNom">{{ requisito.tipoRevisionTercero_CatIdNom }}</dd>
                                                    
                                                    <dt *ngIf="requisito.empresaEmiteRevision_CatIdNom">Nombre de la empresa o persona que lo emite:</dt>
                                                    <dd *ngIf="requisito.empresaEmiteRevision_CatIdNom">{{ requisito.empresaEmiteRevision_CatIdNom }}</dd>
                                                    
                                                    <hr style="border-style: dotted;">                
                                                    <dt>El requisito solicitado es un trámite que se debe realizar con alguna dependencia gubernamental:</dt>
                                                    <dd>
                                                        <span [ngClass]="{'selectsi': requisito.requisitoEsTramite, 'selectno': !requisito.requisitoEsTramite}">
                                                            {{ requisito.requisitoEsTramite ? 'Sí' : 'No' }}
                                                        </span>
                                                    </dd>
                                                    <ng-container *ngIf="requisito.requisitoEsTramite && requisito.requisitoTramite && requisito.requisitoTramite.length > 0">
                                                        <dt>Nombre del trámite o servicio:</dt>
                                                        <dd>
                                                            <a [href]="getBaseHref() + 'detalles/' + requisito.requisitoTramite[0]?.homoclave">
                                                                {{ requisito.requisitoTramite[0]?.nombreTramite || 'No disponible' }}
                                                            </a>
                                                        </dd>
                                                        <dt>Nivel de gobierno:</dt>
                                                        <dd>
                                                            {{ requisito.requisitoTramite[0]?.ordenGobierno || 'No disponible' }}
                                                        </dd>
                                                        <dt>Homoclave:</dt>
                                                        <dd>
                                                            {{ requisito.requisitoTramite[0]?.homoclave || 'No disponible' }}
                                                        </dd>
                                                    </ng-container>
                                                </div>
                                            </div>
                                        </div>
    
                                        
                                    </dl>
                                    <hr>
                                </li>
                            </ol>
                            
                            <div *ngIf="tramite.formatos.length > 0" class="row justify-content-lg-start m-2">
                                <div class="col col-auto">
                                    <strong>Formatos Digitales</strong>
                                </div>
                            </div>
    
                            <ol class="m-2">
                                <li *ngFor="let formato of tramite.formatos">
                                    <dl>
                                        <dt>{{ formato.nombre }}</dt>
                                        <dd>
                                            <form target="_blank" [action]="formato.url">
                                                <input class="btn btn-secondary" type="submit" value="Descargar" />
                                            </form>
                                            <ng-container *ngIf="formato.fechaPublicacionFormato !== null">
                                                <dt>Fecha de publicación del formato:</dt>
                                                <dd>
                                                    {{ formato.fechaPublicacionFormato | date: 'dd/MM/yyyy' }}
                                                </dd>
                                            </ng-container>
                                        </dd>
                                    </dl>
                                </li>
                            </ol>                                             
        
                            <!-- <div *ngIf="tramite.formatos.length > 0" class="row justify-content-lg-start m-2">
                                <div class="col col-auto">
                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th scope="col">#</th>
                                                <th scope="col">Nombre/Identificador</th>
                                                <th scope="col">Fecha de Publicación</th>
                                                <th scope="col">Descarga</th>
                                              </tr>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let formato of tramite.formatos; let i = index">
                                                <th scope="row">{{i+1}}</th>
                                                <td>{{formato.nombre}}</td>
                                                <td></td>
                                                <td>
                                                    <form target="_blank" [action]="formato.url">
                                                        <input class="btn btn-secondary" type="submit" value="Descargar" />
                                                    </form>                                            
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div> -->
                        </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- COMO PUEDO REALIZAR EL TRÁMITE? -->
            <div class="panel panel-default">
              <div class="row cms-plugin cms-plugin-3">
                <div class="col-12 mb-3">
                  <div class="card">
                    <div class="heading-acc d-flex justify-content-between align-items-center p-4 p-md-5" (click)="toggleExpanded(3)">
                      <h3 class="card-title mbr-section-subtitle mbr-fonts-style display-7">
                        <strong>{{ getPanelTitle('¿CÓMO PUEDO REALIZAR EL') }}</strong>
                      </h3>
                      <div class="acc-button-container" [ngClass]="{ 'show': expanded[3] }">
                        <div class="acc-button">
                          <span class="acc-button-line1" [ngClass]="{ 'rotate-line1': expanded[3] }"></span>
                          <span class="acc-button-line2" [ngClass]="{ 'rotate-line2': expanded[3] }"></span>
                        </div>
                      </div>
                    </div>
                    
                    <div class="accordion-body px-4 px-md-5 collapse" [ngClass]="{ 'show': expanded[3] }">
                        <div *ngFor="let opcion of tramite.opcionesRealizarTramite">
                            <div class="row justify-content-lg-start m-2">
                                <div class="col col-auto">
                                    <strong>
                                        Trámite 
                                        <ng-container *ngIf="opcion.opcionRealizarTramite.includes('Medios alternativos') && (!opcion.opcionRealizarTramite.includes('Presencial') && !opcion.existeAppTramite && !opcion.existeWebTramite)">
                                            Medios alternativos
                                        </ng-container>
                                        <ng-container *ngIf="!opcion.opcionRealizarTramite.includes('Medios alternativos')">
                                            {{ opcion.opcionRealizarTramite }}
                                        </ng-container>
                                    </strong>
                                    
                                </div>
                            </div>
                    
                            <!-- Agregar Pasos para Presencial -->
                            <div *ngIf="opcion.opcionRealizarTramite === 'Presencial'">
                                <div *ngFor="let accion of opcion.accionesPresenciallst; let i = index" class="row justify-content-lg-start m-2">
                                    <div class="col col-auto tabulacion-nivel-1">
                                        <strong>{{ i + 1 }}.</strong> {{ accion.accion }}
                                    </div>
                                </div>
                            </div>
                    
                            <!-- Agregar Pasos para Medios Electrónicos -->
                            <div *ngIf="opcion.existeAppTramite || opcion.existeWebTramite">
                                <div *ngIf="opcion.existeAppTramite">
                                    <div class="row justify-content-lg-start m-2">
                                        <div class="col col-auto tabulacion-nivel-1">
                                            <strong>App</strong>
                                        </div>
                                    </div>
                                    <div *ngFor="let accion of opcion.accionesApplst; let i = index" class="row justify-content-lg-start m-2 ">
                                        <div class="col col-auto tabulacion-nivel-2">
                                            <strong>{{ i + 1 }}.</strong> {{ accion.accion }}
                                        </div>
                                    </div>
                                </div>
                    
                                <div *ngIf="opcion.existeWebTramite">
                                    <div class="row justify-content-lg-start m-2">
                                        <div class="col col-auto tabulacion-nivel-1">
                                            <strong>Web</strong>
                                        </div>
                                    </div>
                                    <div *ngFor="let accion of opcion.accionesWeblst; let i = index" class="row justify-content-lg-start m-2 ">
                                        <div class="col col-auto tabulacion-nivel-2">
                                            <strong>{{ i + 1 }}.</strong> {{ accion.accion }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                    
                            <!-- Agregar Pasos para Medios Alternativos -->
                            <div *ngIf="opcion.viaTelefonica || opcion.viaSMS || opcion.viaKiosko || opcion.otro">
                                
                    
                                <div *ngIf="opcion.viaTelefonica">
                                    <div class="row justify-content-lg-start m-2">
                                        <div class="col col-auto tabulacion-nivel-1">
                                            <strong>Teléfono {{ opcion.especifiqueOtro }}</strong>
                                            {{ opcion.especifiqueOtro === 'Telefono' ? opcion.especifiqueOtro : '' }}
                                        </div>
                                    </div>
                                    <div *ngFor="let accion of opcion.accionesTelefonolst; let i = index" class="row justify-content-lg-start m-2 ">
                                        <div class="col col-auto tabulacion-nivel-2">
                                            <strong>{{ i + 1 }}.</strong> {{ accion.accion }}
                                        </div>
                                    </div>
                                </div>
                    
                                <div *ngIf="opcion.viaSMS">
                                    <div class="row justify-content-lg-start m-2">
                                        <div class="col col-auto tabulacion-nivel-1">
                                            <strong>SMS {{ opcion.especifiqueOtro }}</strong>
                                            {{ opcion.especifiqueOtro === 'SMS' ? opcion.especifiqueOtro : '' }}
                                        </div>
                                    </div>
                                    <div *ngFor="let accion of opcion.accionesSMSlst; let i = index" class="row justify-content-lg-start m-2 ">
                                        <div class="col col-auto tabulacion-nivel-2">
                                            <strong>{{ i + 1 }}.</strong> {{ accion.accion }}
                                        </div>
                                    </div>
                                </div>
                    
                                <div *ngIf="opcion.viaKiosko">
                                    <div class="row justify-content-lg-start m-2">
                                        <div class="col col-auto tabulacion-nivel-1">
                                            <strong>Kiosko {{ opcion.especifiqueOtro }}</strong>
                                            {{ opcion.especifiqueOtro === 'Kiosko' ? opcion.especifiqueOtro : '' }}
                                        </div>
                                    </div>
                                    <div *ngFor="let accion of opcion.accionesKioskolst; let i = index" class="row justify-content-lg-start m-2 ">
                                        <div class="col col-auto tabulacion-nivel-2">
                                            <strong>{{ i + 1 }}.</strong> {{ accion.accion }}
                                        </div>
                                    </div>
                                </div>
                    
                                <div *ngIf="opcion.otro">
                                    <div class="row justify-content-lg-start m-2">
                                        <div class="col col-auto tabulacion-nivel-1">
                                            <strong>Otro {{ opcion.especifiqueOtro }}</strong>
                                        </div>
                                    </div>
                                    <div *ngFor="let accion of opcion.accionesOtrolst; let i = index" class="row justify-content-lg-start m-2 ">
                                        <div class="col col-auto tabulacion-nivel-2">
                                            <strong>{{ i + 1 }}.</strong> {{ accion.accion }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                    
                            <!-- Mostrar información adicional si es presencial -->
                            <div *ngIf="opcion.permiteAgendarCita && opcion.opcionRealizarTramite === 'Presencial'">
                                <hr style="border-style: dotted;">
                                <div class="row justify-content-lg-start m-2">
                                    <div class="col col-auto">
                                        <strong>¿Se puede agendar una cita para realizar el trámite?</strong>
                                    </div>
                                    <div class="col col-auto">
                                        {{ opcion.permiteAgendarCita ? 'Sí' : 'No' }}
                                    </div>
                                </div>
                                <div *ngIf="opcion.agendarCitaEnLinea">
                                    <div class="row justify-content-lg-start m-2">
                                        <div class="col col-auto">
                                            <strong>Liga electrónica para agendar una cita en línea para realizar el trámite:</strong>
                                        </div>
                                        <div class="col col-auto">
                                            <a [href]="opcion.ligaCitaEnLinea">{{ opcion.ligaCitaEnLinea }}</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                             <hr>
                        </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- RESOLUCIÓN DEL TRÁMITE O SERVICIO? -->
            <div class="panel panel-default">
              <div class="row cms-plugin cms-plugin-3">
                <div class="col-12 mb-3">
                  <div class="card">
                    <div class="heading-acc d-flex justify-content-between align-items-center p-4 p-md-5" (click)="toggleExpanded(4)">
                      <h3 class="card-title mbr-section-subtitle mbr-fonts-style display-7">
                        <strong>{{ getPanelTitle('¿RESOLUCIÓN DEL') }}</strong>
                      </h3>
                      <div class="acc-button-container" [ngClass]="{ 'show': expanded[4] }">
                        <div class="acc-button">
                          <span class="acc-button-line1" [ngClass]="{ 'rotate-line1': expanded[4] }"></span>
                          <span class="acc-button-line2" [ngClass]="{ 'rotate-line2': expanded[4] }"></span>
                        </div>
                      </div>
                    </div>
                    
                    <div class="accordion-body px-4 px-md-5 collapse" [ngClass]="{ 'show': expanded[4] }">
                        <ng-container *ngIf="tramite.suficienteCumplirRequisitos">
                            <p><strong>Metodología para llevar a cabo la resolución del trámite o servicio:</strong></p>
                            <p> {{ tramite.metodologiaResolucion }}</p>
                        </ng-container>
                        <ng-container *ngIf="!tramite.suficienteCumplirRequisitos">
                            <p><strong>Además de cumplir con todos los requisitos, ¿qué otras condiciones o consideraciones son necesarias?:</strong></p>
                            <p>{{ tramite.criteriosresolucion[0].criDescripcion }}</p>
                        </ng-container>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- EN DÓNDE PUEDO REALIZAR EL TRÁMITE? -->
            <div class="panel panel-default">
              <div class="row cms-plugin cms-plugin-3">
                <div class="col-12 mb-3">
                  <div class="card">
                    <div class="heading-acc d-flex justify-content-between align-items-center p-4 p-md-5" (click)="toggleExpanded(5)">
                      <h3 class="card-title mbr-section-subtitle mbr-fonts-style display-7">
                        <strong>{{ getPanelTitle('¿EN DÓNDE PUEDO REALIZAR EL') }}</strong>
                      </h3>
                      <div class="acc-button-container" [ngClass]="{ 'show': expanded[5] }">
                        <div class="acc-button">
                          <span class="acc-button-line1" [ngClass]="{ 'rotate-line1': expanded[5] }"></span>
                          <span class="acc-button-line2" [ngClass]="{ 'rotate-line2': expanded[5] }"></span>
                        </div>
                      </div>
                    </div>
                    
                    <div class="accordion-body px-4 px-md-5 collapse" [ngClass]="{ 'show': expanded[5]  }">
                        <div class="row justify-content-lg-start m-2">
                            <div class="col col-auto">
                                <strong>Oficinas en donde se puede realizar el trámite</strong>
                            </div>
                        </div>
    
                        <div class="container">
                            <ol class="mt-3">
                                <li *ngFor="let data of data_aux; let i = index">
                                    <strong>{{data.nombre}}</strong>
                                    <dl>
                                        <dt>Domicilio:</dt>
                                        <dd>{{data.direccion}}</dd>
                                        <dt>Teléfono:</dt>
                                        <dd>{{data.telefono}}</dd>
                                        <dt>Horario de atención:</dt>
                                        <dd>
                                            <ul>
                                                <li *ngFor="let d of data.horarios">
                                                    <strong>{{d.dia}}:</strong> {{d.apertura | formatoA}} - {{d.cierre | formatoB}}
                                                </li>
                                            </ul>
                                        </dd>
                                    </dl>
                                <hr>
                                </li>
                            </ol>
                        </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- RESPONSABLE DEL TRÁMITE? -->
            <div class="panel panel-default">
              <div class="row cms-plugin cms-plugin-3">
                <div class="col-12 mb-3">
                  <div class="card">
                    <div class="heading-acc d-flex justify-content-between align-items-center p-4 p-md-5" (click)="toggleExpanded(6)">
                      <h3 class="card-title mbr-section-subtitle mbr-fonts-style display-7">
                        <strong>{{ getPanelNoTitle('RESPONSABLES DEL') }}</strong>
                      </h3>
                      <div class="acc-button-container" [ngClass]="{ 'show': expanded[6] }">
                        <div class="acc-button">
                          <span class="acc-button-line1" [ngClass]="{ 'rotate-line1': expanded[6] }"></span>
                          <span class="acc-button-line2" [ngClass]="{ 'rotate-line2': expanded[6] }"></span>
                        </div>
                      </div>
                    </div>
                    
                    <div class="accordion-body px-4 px-md-5 collapse" [ngClass]="{ 'show': expanded[6] }">
                        <div *ngFor="let contacto of tramite.contactos" class="card mb-2">
                            <div class="card-body">
                                    <div class="row justify-content-lg-start m-2">
                                        <div class="col col-auto" style="text-decoration: underline;">
                                            <ng-container *ngIf="contacto.rolFuncionario != null; else elseBlock">
                                                <strong>{{contacto.rolFuncionario}}</strong> 
                                            </ng-container>
                                            <ng-template #elseBlock>
                                                <strong> {{contacto.tipoContacto}}</strong> 
                                            </ng-template>
                                        </div>
                                    </div>
    
                                    <div class="row justify-content-lg-start m-2 tabulacion-nivel-3">
                                        <div class="col-2 col-auto">
                                            <strong>Nombre:</strong>
                                        </div>
                                        <div class="col-10 col-auto">
                                            {{ contacto.nombre }} {{ contacto.apellidoP }} {{ contacto.apellidoM }}
                                        </div>
                                    </div>
    
                                    <div class="row justify-content-lg-start m-2 tabulacion-nivel-3">
                                        <div class="col-2 col-auto">
                                            <strong>Cargo:</strong>
                                        </div>
                                        <div class="col-10 col-auto">
                                            {{ contacto.cargo }}
                                        </div>
                                    </div>
    
                                    <div class="row justify-content-lg-start m-2 tabulacion-nivel-3">
                                        <div class="col-2 col-auto">
                                            <strong>Correo Electrónico:</strong>
                                        </div>
                                        <div class="col-10 col-auto">
                                            {{ contacto.correo }}
                                        </div>
                                    </div>
    
                                    <div class="row justify-content-lg-start m-2 tabulacion-nivel-3">
                                        <div class="col-2 col-auto">
                                            <strong>Teléfono:</strong>
                                        </div>
                                        <div class="col-10 col-auto">
                                            {{ contacto.telefono }}
                                        </div>
                                    </div>
                            </div>
    
                           
                        </div>
    
                         <!-- Agregar sección para Ligas para consulta en línea (chat) -->
                         <div *ngIf="tramite.traConsultasChatLinea">
                            <hr style="border-style: dotted;">
                            <div class="row justify-content-lg-start m-2">
                                <div class="col col-auto">
                                    <strong>Ligas para consulta en línea (chat):</strong>
                                </div>
                                <div class="col col-auto">
                                    <ng-container *ngIf="tramite.traConsultasChatLineaLigas.toLowerCase().includes('whatsapp')">
                                        <span *ngIf="getPhoneNumber(tramite.traConsultasChatLineaLigas).length > 0">Whatsapp </span>
                                        <a [href]="'https://api.whatsapp.com/send?phone=' + getPhoneNumber(tramite.traConsultasChatLineaLigas)">
                                            <u>{{ getPhoneNumber(tramite.traConsultasChatLineaLigas) }}</u>
                                        </a>
                                    </ng-container>
                                    <ng-container *ngIf="!tramite.traConsultasChatLineaLigas.toLowerCase().includes('whatsapp')">
                                        {{ tramite.traConsultasChatLineaLigas }}
                                    </ng-container>
                                </div>
                            </div>
                        </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- FUNDAMENTO JURÍDICO TRÁMITE? -->
            <div class="panel panel-default" *ngIf="tramite.fundamento.length > 0">
              <div class="row cms-plugin cms-plugin-3">
                <div class="col-12 mb-3">
                  <div class="card">
                    <div class="heading-acc d-flex justify-content-between align-items-center p-4 p-md-5" (click)="toggleExpanded(7)">
                      <h3 class="card-title mbr-section-subtitle mbr-fonts-style display-7">
                        <strong> FUNDAMENTO JURÍDICO </strong>
                      </h3>
                      <div class="acc-button-container" [ngClass]="{ 'show': expanded[7] }">
                        <div class="acc-button">
                          <span class="acc-button-line1" [ngClass]="{ 'rotate-line1': expanded[7] }"></span>
                          <span class="acc-button-line2" [ngClass]="{ 'rotate-line2': expanded[7] }"></span>
                        </div>
                      </div>
                    </div>
                    
                    <div class="accordion-body px-4 px-md-5 collapse" [ngClass]="{ 'show': expanded[7] }">
                        <div class="container">
                            <ol>
                              <ng-container *ngFor="let obj of tramite.fundamento | fundamentos">
                                <li>
                                  <strong>{{
                                    obj.tipo === "OrigenTramite"
                                      ? "Fundamento que da origen al trámite o servicio"
                                      : obj.tipo === "CanalAtencion"
                                      ? "Fundamento del canal de atención"
                                      : obj.tipo === "Formato"
                                      ? "Fundamento del formato"
                                      : obj.tipo === "Requisitos"
                                      ? "Fundamento de los requisitos"
                                      : obj.tipo === "ConservarInformacion"
                                      ? "Fundamento del requerimiento de conservar información"
                                      : obj.tipo === "Montos"
                                      ? "Fundamento del monto o derechos"
                                      : obj.tipo === "CriterioResolucion"
                                      ? "Fundamento de los criterios de resolución"
                                      : obj.tipo === "InspeccionVerificacion"
                                      ? "Fundamento de la inspección, verificación o visita domiciliaria"
                                      : obj.tipo === "PPrevenirSolicitante"
                                      ? "Fundamento del plazo de prevención al Solicitante"
                                      : obj.tipo === "PCumplirPrevencion"
                                      ? "Fundamento del plazo de cumplimiento de la prevención"
                                      : obj.tipo === "PlazoMaximo"
                                      ? "Fundamento del plazo máximo de respuesta"
                                      : obj.tipo === "Vigencia"
                                      ? "Fundamento de la vigencia"
                                      : "Fundamento de la Afirmativa o Negativa Ficta"
                                  }}</strong>
                                </li>
                                <dd *ngFor="let fn of obj.nfund">
                                  <strong style="text-decoration: underline; color: green">{{ fn.nombre }}</strong>
                                  <ul>
                                    <li *ngFor="let fundamento of fn.fund">
                                      <p>
                                        <ng-container *ngIf="fundamento.articulo != null && fundamento.articulo.length">
                                          {{"Artículo(s) "}} <strong>{{ fundamento.articulo }}</strong>{{ ";" }}
                                        </ng-container>
                                        <ng-container *ngIf="fundamento.fraccion != null && fundamento.fraccion.length">
                                          {{"Fracción(s) "}} <strong>{{ fundamento.fraccion }}</strong>{{ ";" }}
                                        </ng-container>
                                        <ng-container *ngIf="fundamento.inciso != null && fundamento.inciso.length">
                                          {{"Inciso "}} <strong>{{ fundamento.inciso }}</strong>{{ ";" }}
                                        </ng-container>
                                        <ng-container *ngIf="fundamento.parrafo != null && fundamento.parrafo.length">
                                          {{"Párrafo "}} <strong>{{ fundamento.parrafo }}</strong>{{ ";" }}
                                        </ng-container>
                                        <ng-container *ngIf="fundamento.numero != null && fundamento.numero.length">
                                          {{"Número "}} <strong>{{ fundamento.numero }}</strong>{{ ";" }}
                                        </ng-container>
                                        <ng-container *ngIf="fundamento.letra != null && fundamento.letra.length">
                                          {{"Letra "}} <strong>{{ fundamento.letra }}</strong>{{ ";" }}
                                        </ng-container>
                                        <ng-container *ngIf="fundamento.otro != null && fundamento.otro.length">
                                          {{"(Otro) "}} <strong>{{ fundamento.otro }}</strong>{{ ";" }}
                                        </ng-container>
                                        
                                        <!-- Datos adicionales -->
                                        {{ getDatosAdicionales(fundamento) }}
                                      </p>
                                    </li>
                                  </ul>
                                </dd>
                                <hr />
                              </ng-container>
                            </ol>
                          </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
        </div>
        
        
    </div>
</ng-template>